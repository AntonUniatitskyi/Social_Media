{% extends 'social/base.html' %}

{% block title %}
    –ß–∞—Ç–∏
{% endblock title %}

{% block content %}
<div class="max-w-2xl mx-auto p-4">
    <div class="flex flex-row items-center gap-2 mb-6">
        <h1 class="text-3xl font-bold text-gray-800">–ß–∞—Ç–∏</h1>
        <a href="{% url 'new_groupchat' %}"><ion-icon class="w-7 h-7" name="add-circle"></ion-icon></a>
    </div>

    <ul class="space-y-2">
        <!-- –ü—É–±–ª—ñ—á–Ω–∏–π —á–∞—Ç -->
        <li>
            <a href="{% url 'chat_home' %}" 
               class="flex items-center justify-between p-4 bg-blue-50 hover:bg-blue-100 rounded-xl shadow-sm transition">
                <span class="text-blue-900 font-medium">üåê –ü—É–±–ª—ñ—á–Ω–∏–π —á–∞—Ç</span>
            </a>
        </li>
        <li>
            <a href="{% url 'favorites_chat' %}" 
               class="flex items-center justify-between p-4 bg-blue-50 hover:bg-blue-100 rounded-xl shadow-sm transition">
                <span class="text-blue-900 font-medium">‚≠ê –í–∏–±—Ä–∞–Ω–µ</span>
            </a>
        </li>
        {% with "–í–∏–±—Ä–∞–Ω–µ ("|add:user.username|add:")" as favorites_name %}
            <hr class="bottom-2 mt-2">
            <h2 class="text-2xl text-center font-bold mt-2">-- –ì—Ä—É–ø–∏ --</h2>
            {% for chatroom in user.chat_groups.all %}
                {% if chatroom.group_chat_name and chatroom.group_chat_name != favorites_name %}
                    <li>
                        <a href="{% url 'chatroom' chatroom.group_name %}" 
                        class="flex items-center justify-between p-4 home-card hover:bg-gray-100 rounded-xl shadow-sm transition">
                            <span class="text-gray-800 font-medium" style="text-decoration: none;">
                                {{ chatroom.group_chat_name|slice:":30" }}
                            </span>
                        </a>
                    </li>
                {% endif %}
            {% endfor %}
        {% endwith %}

        <!-- –ü—Ä–∏–≤–∞—Ç–Ω—ñ —á–∞—Ç–∏ -->
        <hr class="bottom-2 mt-2">
        <h2 class="text-2xl text-center font-bold mt-2">-- –ü—Ä–∏–≤–∞—Ç–Ω—ñ —á–∞—Ç–∏ --</h2>
        {% for chatroom in user.chat_groups.all %}
            {% if chatroom.is_private %}
                {% for member in chatroom.members.all %}
                    {% if member != user %}
                        <li>
                            <a href="{% url 'chatroom' chatroom.group_name %}" 
                               class="flex items-center justify-between p-4 home-card hover:bg-gray-100 rounded-xl shadow-sm transition">
                                <div class="flex items-center gap-3">
                                    <img src="{{ member.profile.get_avatar_url }}" 
                                         alt="{{ member.profile.user.username }}" 
                                         class="w-10 h-10 rounded-full object-cover">
                                    <div class="text-gray-800 font-medium">
                                        {{ member.profile.user.username }}
                                    </div>
                                </div>
                            </a>
                        </li>   
                    {% endif %}
                {% endfor %}
            {% endif %}
        {% empty %}
            <h2 class="text-xl text-center font-bold">–£ –≤–∞—Å –Ω–µ–º–∞—î —á–∞—Ç—ñ–≤</h2>
        {% endfor %}
    </ul>
</div>
{% endblock content %}
